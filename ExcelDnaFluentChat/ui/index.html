<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fluent Chat for Excel</title>
  <script type="module" src="https://unpkg.com/@fluentui/web-components"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    :root { --pad: 10px; }
    body { margin:0; font-family: Segoe UI, system-ui, sans-serif; }
    .app { display:flex; flex-direction:column; height:100vh; }
    .topbar { display:flex; gap:8px; align-items:center; padding:8px var(--pad); border-bottom:1px solid #e5e5e5; }
    .content { display:flex; flex-direction:column; gap:8px; padding:var(--pad); height:100%; box-sizing:border-box; }
    .row { display:flex; gap:8px; align-items:center; }
    .grow { flex:1; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; white-space:pre-wrap; background:rgba(0,0,0,.03); padding:8px; border-radius:8px; max-height:120px; overflow:auto; }
    .answer { overflow:auto; flex:1; border:1px solid #e5e5e5; border-radius:8px; padding:10px; background:var(--answer-bg, #fff); }
    .hidden { display:none; }
    .toast { position:fixed; bottom:12px; right:12px; background:#000; color:#fff; padding:8px 12px; border-radius:6px; opacity:.9; }
  </style>
</head>
<body>
<div class="app">
  <div class="topbar">
    <h4 class="grow" style="margin:4px 0;">Excel Assistant</h4>

    <fluent-segmented-control id="verbosity" appearance="outline">
      <fluent-option value="Concise" selected>Concise</fluent-option>
      <fluent-option value="Detailed">Detailed</fluent-option>
    </fluent-segmented-control>

    <fluent-button id="themeBtn" appearance="stealth" title="Toggle theme">ðŸŒ“</fluent-button>
    <fluent-button id="helpBtn" appearance="accent" title="Help">?</fluent-button>
  </div>

  <div class="content">
    <div class="row">
      <fluent-text-area id="prompt" class="grow" placeholder="Type a questionâ€¦ (Enter to send, Ctrl+Enter for newline)"></fluent-text-area>
      <fluent-button id="sendBtn" appearance="accent">Summarize</fluent-button>
    </div>
    <div class="row" style="justify-content:space-between; font-size:12px; color:gray;">
      <span id="counter">0 chars</span>
      <fluent-progress-ring id="spinner" class="hidden"></fluent-progress-ring>
    </div>

    <fluent-card>
      <div style="font-weight:600;margin-bottom:6px;">Selection preview</div>
      <div id="sel" class="mono">(no selection)</div>
    </fluent-card>

    <fluent-card style="flex:1;display:flex;flex-direction:column;min-height:120px;">
      <div style="font-weight:600;margin-bottom:6px;">Answer</div>
      <div id="ans" class="answer"></div>
    </fluent-card>
  </div>
</div>

<div id="toast" class="toast hidden"></div>
<script src="app.js"></script>
</body>
</html>